USE JoinSp

CREATE TABLE IMPIEGO (
	IDImpiego INT IDENTITY NOT NULL PRIMARY KEY,
	TipoImpiego NVARCHAR(30) NOT NULL,
	Data_Assunzione DATETIME NOT NULL
	)

CREATE TABLE IMPIEGATO (
	IDImpiegato INT IDENTITY NOT NULL PRIMARY KEY,
	Cognome NVARCHAR(20) NOT NULL,
	Nome NVARCHAR(20) NOT NULL,
	CodiceFiscale CHAR(16) NOT NULL,
	Eta CHAR(2) NOT NULL,
	RedditoMensile DECIMAL(16,2) NOT NULL,
	DetrazioneFiscale BIT DEFAULT 1,
	IDImpiego INT NOT NULL

	CONSTRAINT FK_IMPIEGATO_IMPIEGO
	FOREIGN KEY (IDImpiego) REFERENCES IMPIEGO (IDImpiego) 	
)


INSERT INTO IMPIEGO VALUES ('Tempo Indeterminato', '20070101 10:00')
INSERT INTO IMPIEGO VALUES ('Tempo determinato', '20171101 08:00')
INSERT INTO IMPIEGO VALUES ('Stage', '20200517 11:00')
INSERT INTO IMPIEGO VALUES ('P.IVA', '20080517 12:00')






INSERT INTO IMPIEGATO VALUES ('Lerra', 'Nicola', 'LRRNCL91D04G766M', 31, 3560, 1, 1)
INSERT INTO IMPIEGATO VALUES ('Stano', 'Bruno', 'BRRN83627367GG', 28, 2260.50, 0,1)
INSERT INTO IMPIEGATO VALUES ('Urso', 'Giovanni', 'URSS2736482GG', 32, 2060.10,1, 2 )
INSERT INTO IMPIEGATO VALUES ('Senatore', 'Luca', 'SNTR24674L234', 41, 6560.90, 0, 1)
INSERT INTO IMPIEGATO VALUES ('Ponzani', 'Simone', 'PNNZ2364273S26', 35, 15560.70, 0, 1)
INSERT INTO IMPIEGATO VALUES ('Martini', 'Lamberto', 'LMBR2376472T637', 27, 1560.50, 1, 2)
INSERT INTO IMPIEGATO VALUES ('Crisci', 'Luigi', 'LCRS26374627G', 22, 960.30, 1,6)
INSERT INTO IMPIEGATO VALUES ('Dabicco', 'Roberto', 'RBB', 31, 2560.80, 1, 1)
INSERT INTO IMPIEGATO VALUES ('Di Pisa', 'Giuseppe', 'GPP17461337D76', 29, 4560.15, 0, 1)
INSERT INTO IMPIEGATO VALUES ('Lazuka', 'Dimitri', 'DRMT2367246t5', 23, 600.43, 1, 6)
INSERT INTO IMPIEGATO VALUES ('Laguda', 'Stefano', 'STG2745L454', 22, 5560.56, 0, 1)
INSERT INTO IMPIEGATO VALUES ('Di Filippo', 'Daniela', 'DFFL356125M', 39, 8560.67, 1, 1)
INSERT INTO IMPIEGATO VALUES ('Pourbijan', 'Aras', 'RATRYTT25626', 21, 1900.86, 0, 2)
INSERT INTO IMPIEGATO VALUES ('Presaghi', 'Chiara', 'PRS2367436G', 20, 1060.68, 1,2)
INSERT INTO IMPIEGATO VALUES ('Puccio', 'Marco', 'MRCP3635C', 36, 5999.99, 1, 1)
INSERT INTO IMPIEGATO VALUES ('Strada', 'Gino', 'GGDN83736', 33, 999.99, 1, 7)
INSERT INTO IMPIEGATO VALUES ('Castaldi', 'Ciro', 'CST436437L', 22, 699.99, 1, 7)



SELECT * FROM IMPIEGATO WHERE Eta > 29
SELECT * FROM IMPIEGATO WHERE RedditoMensile > 800
SELECT * FROM IMPIEGATO WHERE DetrazioneFiscale = 1
SELECT * FROM IMPIEGATO WHERE DetrazioneFiscale = 0
SELECT * FROM IMPIEGATO WHERE Cognome LIKE 'L%' ORDER BY Cognome, Nome
SELECT COUNT(*) AS NumeroTotaleImpiegati FROM Impiegato
SELECT AVG(RedditoMensile) AS MediaRedditiMensili FROM IMPIEGATO
SELECT SUM(RedditoMensile) AS SommaRedditiMensili FROM IMPIEGATO
SELECT MAX(RedditoMensile) AS MassimoRedditoMensile FROM IMPIEGATO
SELECT MIN(RedditoMensile) AS MinimoRedditoMensile FROM IMPIEGATO
SELECT * FROM IMPIEGO WHERE Data_Assunzione BETWEEN '20070101' AND '20080101'
SELECT AVG(Eta) AS EtaMedia FROM IMPIEGATO


